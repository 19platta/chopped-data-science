---
title: "Chopped Analysis"
author: "Annabelle Platt and Alana Huitric"
output: github_document
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
library(tidyverse)
library(stringr)
filename = "./data/chopped.csv"
chopped_df <- read_csv(filename)

chopped_df
```


```{r}
food_df <-
  chopped_df %>% 
  select(series_episode, appetizer, entree, dessert) %>% 
  separate(
    appetizer, 
    into = c("app_ing1", "app_ing2", "app_ing3", "app_ing4", "app_ing5"), 
    sep = ", "
  ) %>% 
  separate(
    entree,
    into = c("ent_ing1", "ent_ing2", "ent_ing3", "ent_ing4", "ent_ing5"), 
    sep = ", "
  ) %>% 
  separate(
    dessert,
    into = c("des_ing1", "des_ing2", "des_ing3", "des_ing4", "des_ing5"), 
    sep = ", "
  ) %>%  
  pivot_longer(
    names_to = "category",
    values_to = "ingredient",
    cols = -series_episode,
  ) %>% 
  drop_na() %>% 
  separate(
    category,
    into = "course",
    sep = "_"
  ) %>% 
  group_by(ingredient) %>%
  mutate(count=n()) 
  
food_df
```

```{r}
food_df %>% 
  arrange(desc(count), ingredient) %>%
  filter(count > 10) %>% 
  
  ggplot(aes(ingredient, count)) + 
  geom_point() + 
  coord_flip()
```
```{r}
df_q1 <- food_df %>% 
  arrange(desc(count), ingredient) %>%
  filter(count > 10) %>% 
  
  ggplot() + 
  geom_histogram(aes(series_episode, color = ingredient)) +
  facet_wrap(~course)
df_q1
```
```{r chef}
df_chef <- chopped_df %>% 
  pivot_longer(
    names_to = "Number",
    values_to = "Chef_Name",
    cols = c(contestant1, contestant2, contestant3, contestant4),
  ) %>% 
  select("Chef_Name","Number","series_episode") 

df_info <- chopped_df %>% 
  pivot_longer(
    names_to = "help",
    values_to = "Info",
    cols = c(contestant1_info, contestant2_info, contestant3_info, contestant4_info),
  ) %>% 
  select("help", "Info")

df_chef_info_raw <- 
  bind_cols(
    df_chef, df_info
  ) %>% 
  select("Chef_Name", "Info", "series_episode")

df_chef
df_info
df_chef_info_raw
```
```{r}
df_chef_info_raw %>% 
  mutate(
    noChef = !str_count(Info,"")
  ) %>% 
  filter(noChef == TRUE)
```

```{r}
df_chef_info_process <- df_chef_info_raw %>%
  separate(
    col = Info,
    sep = -2,
    into = c("Info","State"),
  ) %>% 
  mutate(
    Private = str_count(Info,"Private") != 0,
    Pastry = str_count(Info,"Pastry")!= 0,
    Catering = str_count(Info, "Catering")!= 0,
    Owner = str_count(Info, "Owner") != 0,
    Executive = str_count(Info, "Executive")!= 0,
    IsChef = str_count(Info, "")!= 0
  ) %>% 
  select(-Info)
  
df_chef_info_process
```

```{r}

```


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
